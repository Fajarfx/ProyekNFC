<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web NFC Sample</title>
    <style>
      /* Gaya CSS sederhana untuk memperbaiki tampilan */
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      #output {
        margin-top: 20px;
      }
      #log {
        white-space: pre-wrap; /* Agar log terlihat seperti baris baru */
      }
    </style>
</head>
<body>
    <button id="scanButton">Scan</button>
    <button id="writeButton">Write</button>

    <h3>Live Output</h3>
    <div id="output">
        <div id="status">Web NFC is not available. Please make sure the "Experimental Web Platform features" flag is enabled on Android.</div>
        <pre id="log"></pre>
    </div>

    <script>
        // Function to handle logging
        function log(message) {
            const logElement = document.getElementById('log');
            logElement.textContent += message + '\n';
        }

        // Check if Web NFC API is supported
        if ('NDEFReader' in window) {
            document.getElementById('status').textContent = 'Web NFC is available!';
        } else {
            document.getElementById('status').textContent = 'Web NFC is not available.';
        }

        // Scan NFC Button Event
        document.getElementById('scanButton').addEventListener('click', async () => {
            log('User clicked scan button');

            try {
                const ndef = new NDEFReader();
                await ndef.scan();
                log('Scan started');

                ndef.addEventListener('readingerror', () => {
                    log('Argh! Cannot read data from the NFC tag. Try another one?');
                });

                ndef.addEventListener('reading', ({ message, serialNumber }) => {
                    log(`Serial Number: ${serialNumber}`);
                    log(`Records: (${message.records.length})`);
                    message.records.forEach(record => {
                        log(`Record: ${record.recordType}, Data: ${new TextDecoder().decode(record.data)}`);
                    });
                });
            } catch (error) {
                log('Argh! ' + error);
            }
        });

        // Write NFC Button Event
        document.getElementById('writeButton').addEventListener('click', async () => {
            log('User clicked write button');

            try {
                const ndef = new NDEFReader();
                await ndef.write({ records: [{ recordType: 'text', data: 'Hello world!' }] });
                log('Message written');
            } catch (error) {
                log('Argh! ' + error);
            }
        });
    </script>
</body>
</html>
